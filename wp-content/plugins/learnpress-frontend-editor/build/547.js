"use strict";(self.webpackChunklearnpress_frontend_editor=self.webpackChunklearnpress_frontend_editor||[]).push([[547],{7547:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var r=a(9307),l=a(5998),i=a(6191),n=a(6989),c=a.n(n),s=a(845),o=a(8100),d=a(4312);function m(){var e;const t=(0,l.v9)(i.Ib),[a,n]=(0,r.useState)([]),[m,u]=(0,r.useState)(0),[v,p]=(0,r.useState)(!1),[f,g]=(0,r.useState)(""),[x,h]=(0,r.useState)("success"),w=(0,r.useRef)(null),{data:E,error:y}=(0,o.ZP)("/lp/certificate/admin/v1/course-metabox"+(null!=t&&t.id?`?course_id=${t.id}`:""),(e=>c()({path:e}))),b=!E&&!y;(0,r.useEffect)((()=>{E&&(n(null==E?void 0:E.data),u((null==E?void 0:E.active)||0))}),[E]),(0,r.useEffect)((()=>{w.current&&window.LP_Certificate&&w.current.querySelectorAll(".lp-certificate-list").forEach((e=>{var t,a;null===(t=e.parentNode.querySelector(".certificate-result"))||void 0===t||t.remove();const r=`#${e.getAttribute("id")}`,l=e.querySelector(".lp-data-config-cer")&&JSON.parse(e.querySelector(".lp-data-config-cer").value);LP_Certificate(r,l),null===(a=e.querySelector(".canvas-container"))||void 0===a||a.remove()}))}),[w,a]);const N=async e=>{p(!0);try{const a=await c()({path:"/lp/certificate/admin/v1/course-metabox/assign",method:"POST",data:{certificate_id:e,course_id:(null==t?void 0:t.id)||0}});if(null==a||!a.success)throw new Error((null==a?void 0:a.message)||"");g((null==a?void 0:a.message)||""),h("success"),u((null==a?void 0:a.active)||0)}catch(e){g(e.message),h("error")}finally{p(!1)}};return(0,r.createElement)("div",{ref:w},b?(0,r.createElement)("div",{className:"flex items-center gap-x-2"},(0,r.createElement)("span",{className:"flex items-center justify-center"},(0,r.createElement)("svg",{className:"animate-spin h-5 w-5 text-indigo-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},(0,r.createElement)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.createElement)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"}))),(0,r.createElement)("span",{className:"text-gray-600"},(0,s.__)("Loadingâ€¦"))):(0,r.createElement)("div",{className:"relative"},(0,r.createElement)("div",{className:"flex items-center flex-wrap gap-6"},a&&a.map((e=>{var t;return(0,r.createElement)("div",{className:"relative w-80 rounded-lg shadow overflow-hidden [&>img]:object-cover [&>img]:object-center [&>img]:w-full [&>img]:h-60 "+(m===e.id?"border-2 border-indigo-600":"border"),key:e.id},(0,r.createElement)("div",{className:"lp-certificate-list",id:`lp-certificate-${e.id}`,"data-id":e.id},(0,r.createElement)("div",{className:"certificate-preview-inner"},(0,r.createElement)("canvas",null)),(0,r.createElement)("input",{className:"lp-data-config-cer",type:"hidden",value:JSON.stringify(null==e?void 0:e.data)})),(0,r.createElement)("div",{className:"flex items-center justify-between text-sm px-3 py-2 gap-x-2 bg-gray-100"},(0,r.createElement)("div",{className:"truncate text-gray-600"},null==e||null===(t=e.data)||void 0===t?void 0:t.name),(0,r.createElement)("div",{className:"flex items-center gap-x-2"},m===e.id?(0,r.createElement)("button",{onClick:()=>N(0),className:"relative ring-1 ring-black ring-opacity-5 bg-red-600 text-white text-sm px-3 py-1.5 flex items-center rounded font-medium"},(0,s.__)("Remove")):(0,r.createElement)("button",{onClick:()=>N(e.id),className:"relative ring-1 ring-black ring-opacity-5 bg-indigo-600 text-white text-sm px-3 py-1.5 flex items-center rounded font-medium"},(0,s.__)("Assign")),(0,r.createElement)("a",{href:null==e?void 0:e.edit_link,className:"relative border text-gray-600 bg-white text-sm px-3 py-1.5 flex items-center rounded font-medium hover:bg-gray-50"},(0,s.__)("Edit")))),m===e.id&&(0,r.createElement)("span",{className:"absolute right-4 top-4"},(0,r.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-6 h-6 text-indigo-600"},(0,r.createElement)("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z",clipRule:"evenodd"}))),v&&(0,r.createElement)("div",{className:"absolute inset-0 bg-gray-100/80 z-20"}))})))),(0,r.createElement)("div",{className:"w-full mt-4"},(0,r.createElement)("a",{href:`${null===(e=learnpress_frontend_editor)||void 0===e?void 0:e.admin_url}post-new.php?post_type=lp_cert`,target:"_blank",rel:"noopener noreferrer",className:"border gap-x-2 text-white bg-indigo-600 text-sm px-3 py-2 inline-flex items-center rounded-md font-medium"},(0,r.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 002.25-2.25V6a2.25 2.25 0 00-2.25-2.25H6A2.25 2.25 0 003.75 6v2.25A2.25 2.25 0 006 10.5zm0 9.75h2.25A2.25 2.25 0 0010.5 18v-2.25a2.25 2.25 0 00-2.25-2.25H6a2.25 2.25 0 00-2.25 2.25V18A2.25 2.25 0 006 20.25zm9.75-9.75H18a2.25 2.25 0 002.25-2.25V6A2.25 2.25 0 0018 3.75h-2.25A2.25 2.25 0 0013.5 6v2.25a2.25 2.25 0 002.25 2.25z"})),(0,s.__)("Create new certificate"))),(0,r.createElement)(d.Z,{type:x,message:f,setMessage:g}))}}}]);