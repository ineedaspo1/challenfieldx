document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("fstRegistrationForm"),t=document.getElementById("fstResetPasswordForm");function n(e){e.classList.toggle("loading"),e.disabled=!e.disabled}function s(e,t,s){var r=document.getElementById(t);n(r),document.querySelectorAll(".error.text-danger").forEach((function(e){e.parentNode.parentNode.classList.remove("is-error"),e.remove()}));var o=new FormData(e),i=new XMLHttpRequest;i.open("POST",s,!0),i.responseType="json",i.setRequestHeader("X-WP-Nonce",window.fluentSupportPublic.nonce),i.onload=function(){if(200===this.status)if(this.response.redirect)window.location.href=this.response.redirect;else if(this.response.message){var t=document.createElement("div");t.classList.add("success","text-success"),t.innerHTML=this.response.message,e.appendChild(t)}else window.location.reload();else{var s=this.response.error;if((!s&&this.response.message||s&&403===this.response.data.status)&&(s=this.response.message),s){var o=document.createElement("div");o.classList.add("error","text-danger"),o.innerHTML=s,e.appendChild(o)}else for(var i in this.response){var d=document.getElementById("fst_"+i);if(d){var a=document.createElement("div");a.classList.add("error","text-danger"),a.innerHTML=Object.values(this.response[i])[0],d.parentNode.insertBefore(a,d.nextSibling),d.parentNode.parentNode.classList.add("is-error")}}}n(r)},i.send(o)}function r(e,t,n){e.preventDefault(),t.parentNode.parentNode.classList.toggle("hide"),document.querySelector(n).classList.toggle("hide")}e&&e.addEventListener("submit",(function(t){t.preventDefault(),s(e,"fst_submit",window.fluentSupportPublic.signup)})),t&&t.addEventListener("submit",(function(e){e.preventDefault(),s(t,"fst_reset_pass",window.fluentSupportPublic.resetPass)})),document.getElementById("fs_show_signup")&&document.getElementById("fs_show_signup").addEventListener("click",(function(e){r(e,this,".fst_registration_wrapper")})),document.getElementById("fs_show_reset_password")&&document.getElementById("fs_show_reset_password").addEventListener("click",(function(e){r(e,this,".fst_reset_pass_wrapper")})),document.getElementById("fs_show_login")&&document.getElementById("fs_show_login").addEventListener("click",(function(e){r(e,this,".fst_login_wrapper")}));var o=document.querySelectorAll("#fst_login_form form");if(o&&o[0]){var i=o[0];i.addEventListener("submit",(function(e){e.preventDefault();var t=document.getElementById("wp-submit");n(t),document.querySelectorAll(".error.text-danger").forEach((function(e){e.parentNode.parentNode.classList.remove("is-error"),e.remove()}));var s=new FormData(o[0]);s.append("_support_login_nonce",window.fluentSupportPublic.fsupport_login_nonce);var r=new XMLHttpRequest;r.open("POST",window.fluentSupportPublic.login,!0),r.responseType="json",r.setRequestHeader("X-WP-Nonce",window.fluentSupportPublic.nonce),r.onload=function(){if(200===this.status)this.response.redirect?(window.location.href=this.response.redirect,setTimeout((function(){window.location.reload()}),1500)):window.location.href=window.fluentSupportPublic.redirect_fallback;else{var e=this.response.error;if(this.response&&403===this.status&&(e=this.response.message),e){var s=document.getElementsByClassName("login-submit");s=s.length?s[0]:i;var r=document.createElement("div");r.classList.add("error","text-danger"),r.innerHTML=e,s.parentNode.insertBefore(r,s.nextSibling)}else for(var o in this.response){var d=document.getElementById("fst_"+o);if(d){var a=document.createElement("div");a.classList.add("error","text-danger"),a.innerHTML=Object.values(this.response[o])[0],d.parentNode.insertBefore(a,d.nextSibling),d.parentNode.parentNode.classList.add("is-error")}}}n(t)},r.send(s)}))}}));